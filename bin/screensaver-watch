#!/bin/bash

LOG=/home/mmikhailov/.screensaver-activity.log

echo "$(date --rfc-3339=seconds) Starting" >> $LOG
echo "$(date --rfc-3339=seconds) Unblank" >> $LOG

xscreensaver-command -watch | while read line; do
	event=$(echo $line | awk '{print $1}')
	if [[ "$event" == "LOCK" ]]; then

		# commands to run on screen lock
		echo "$(date --rfc-3339=seconds) Lock" >> $LOG

		slackstatus away

	elif [[ "$event" == "UNBLANK" ]]; then

		# commands to run on screen unlock
		echo "$(date --rfc-3339=seconds) Unblank" >> $LOG
		when > /dev/null

		slackstatus auto
	fi
done
